# binning_process.fitter

[Назад к списку компонентов](../README.md)

## Назначение

Компонент обучает модель, которая делает оптимальное квантование для всех полей во входном датасете (порт **Обучающая выборка**), за исключением поля с идентификатором (вызывается метод `binning_process.fit`). Компонент также осуществляет "прогон" набора данных (порт **Скоринговая выборка**) через готовую модель (вызывается метод `binning_process.transform`).

Выходная переменная — бинарная.

Ссылка на описание класса `BinningProcess` из библиотеки **OptBinning** [здесь](https://gnpalencia.org/optbinning/binning_process.html).

## Входные порты

| Название                | Тип        |
|:------------------------|:-----------|
| Обучающая выборка       | Таблица    |
| Скоринговая выборка     | Таблица    |
| Входные переменные      | Переменные |

### Структура таблицы "Обучающая выборка"

На вход можно подать данные любой структуры, но обязательно требуется поле с событием (целевое поле).

### Структура таблицы "Скоринговая выборка"

Структура набора данных должна быть идентична структуре, подаваемой на порт **Обучающая выборка**.

### Переменные в порте "Входные переменные"

| №  | Метка                           | Тип                                | Значение по умолчанию   |
|:---|:--------------------------------|:-----------------------------------|:------------------------|
| 1  | Поле с идентификатором          | ![](./img/string.svg) Строковый    | null                    |
| 2  | Целевое поле                    | ![](./img/string.svg) Строковый    | null                    |
| 3  | Оставлять target закодированным | ![](./img/logical.svg) Логический  | true                    |
| 4  | Путь к файлу                    | ![](./img/string.svg) Строковый    | null                    |
| 5  | Имя файла                       | ![](./img/string.svg) Строковый    | null                    |
| 6  | Вывести итоги                   | ![](./img/logical.svg) Логический  | false                   |
|    | Метка события                   | ![](./img/string.svg) Строковый    | Yes                     |   
| 8  | Выходное поле с разбиением      | ![](./img/string.svg) Строковый    | IsTestSet               |
| 9  | Дополнительные параметры        | ![](./img/string.svg) Строковый    | null                    |
| 10 | binning_fit_params              | ![](./img/string.svg) Строковый    | null                    |
| 11 | categorical_variables           | ![](./img/string.svg) Строковый    | null                    |
| 12 | selection_criteria              | ![](./img/string.svg) Строковый    | { 'iv': {'min': 0.02}}  |
| 13 | max_n_bins                      | ![](./img/integer.svg) Целый       | 6                       |
| 14 | transform_metric                | ![](./img/string.svg) Строковый    | woe                     |
| 15 | Виртуальное окружение           | ![](./img/string.svg) Строковый    |null                     |

1. **Поле с идентификатором** — необязательный столбец, в котором содержится информация об идентификаторе объекта;
2. **Целевое поле** — поле с событием, должно содержать минимум два уникальных значения;
3. **Оставлять target закодированным** — в выходном наборе целевое поле будет представлено как 0/1;
4. **Путь к файлу** — полный путь к файлу, где лежит файл с именем `model_filename`;
5. **Имя файла** — модель должна быть представлена в виде сериализованного объекта Python: pickle или joblib;
6. **Вывести итоги** — при значении **true** в выходном наборе данных будут выведены WoE-индексы через вызов метода `binning_process.summary()`;
7. **Метка события** — значение, которое принимает событие (переменная **Целевое поле**), все остальные значения будут записаны в не-события;
8. **Выходное поле с разбиением** — имя выходного столбца, в котором будет значение **True**, если тестовое множество
9. **Дополнительные параметры** — дополнительные параметры, которые передаются в класс **BinningProcess** после вызова метода `set_params`;
10. **binning_fit_params** — вызывается метод **Binning_process.Set_params** и строка, содержащая параметры, передается в аргументы метода. В эту строку не следует записывать значения variable_names, а также: `categorical_variables`, `selection_criteria`, `max_n_bins`. Последние три задаются отдельными параметрами;
11. **categorical_variables** — список имен столбцов через занятую, которые требуется обрабатывать как дискретные (категориальные);
12. **selection_criteria** — критерий отбора переменных в выходной набор данных. По умолчанию это условие отбора с IV > 0.02;
13. **max_n_bins** — максимальное число бинов;
14. **transform_metric** — метод для представления выходного значения в бине после оптимального квантования. Допустимые значения: `woe` (по умолчанию), `event_rate`, `indices`, `bins`.
15. **Виртуальное окружение** — путь к файлу интерпретатора Python.

## Выходные порты

| Название              | Тип        |
|:----------------------|:-----------|
| Выходной набор данных | Таблица    |

### Структура таблицы "Выходной набор данных"

В выходной набор данных попадают все столбцы исходного датасета, которые удовлетворяют критерию отбора в процедуре оптимального квантования. Если порт **Тестовая выборка** был непустой, то он объединяется с обучающей выборкой и создается столбец с именем из переменной **Выходное поле с разбиением** и меткой **Тестовое множество** для разделения этих двух наборов данных. 